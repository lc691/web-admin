{% extends "base.html" %}
{% block content %}

<style>
    .page-wrapper {
        background: #f4f6f9;
        padding: 30px;
    }

    .lux-card {
        background: #ffffff;
        border-radius: 16px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.06);
        overflow: hidden;
    }

    .lux-header {
        padding: 20px 25px;
        background: linear-gradient(135deg, #1f2937, #374151);
        color: white;
    }

    .lux-body {
        padding: 30px;
    }

    .form-control,
    .form-select {
        border-radius: 12px;
        padding: 12px 15px;
        border: 1px solid #e5e7eb;
    }

    .form-control:focus,
    .form-select:focus {
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        border-color: #3b82f6;
    }

    .thumbnail-preview {
        width: 100%;
        max-width: 260px;
    }

    .ratio-box {
        position: relative;
        width: 100%;
        padding-top: 150%;
        overflow: hidden;
        border-radius: 16px;
        background: #f3f4f6;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
    }

    .preview-img {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .btn-save {
        background: linear-gradient(135deg, #2563eb, #1e40af);
        color: white;
        border: none;
        padding: 10px 26px;
        border-radius: 12px;
        font-weight: 500;
        box-shadow: 0 8px 18px rgba(37, 99, 235, 0.25);
        transition: 0.25s ease;
    }

    .btn-save:hover {
        transform: translateY(-2px);
    }

    .btn-cancel {
        background: #f3f4f6;
        color: #374151;
        padding: 10px 22px;
        border-radius: 12px;
        border: 1px solid #e5e7eb;
        text-decoration: none;
    }

    @media (max-width:768px) {

        .btn-save,
        .btn-cancel {
            width: 100%;
        }

        .action-group {
            flex-direction: column;
        }
    }
</style>

<div class="page-wrapper">

    <div class="lux-card">

        <div class="lux-header">
            <div class="fw-semibold">Tambah Show Baru</div>
            <small class="opacity-75">Masukkan detail informasi show</small>
        </div>

        <div class="lux-body">

            <form method="post" action="/shows/add">

                <div class="row g-4">

                    <!-- LEFT COLUMN -->
                    <div class="col-md-8">

                        <div class="mb-4">
                            <label class="form-label fw-semibold">Judul</label>
                            <input type="text" name="title" class="form-control" required>
                        </div>

                        <div class="mb-4">
                            <label class="form-label fw-semibold">Sinopsis</label>
                            <textarea name="sinopsis" class="form-control" rows="5"></textarea>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Genre</label>
                                <input type="text" name="genre" class="form-control">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Source</label>
                                <select name="source_id" class="form-select" required>
                                    <option value="">-- Pilih Source --</option>
                                    {% for src in sources %}
                                    <option value="{{ src.id }}">
                                        {{ src.label }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="mt-4">
                            <label class="form-label fw-semibold">Hashtags</label>
                            <input type="text" name="hashtags" class="form-control" placeholder="#romance #drama">
                        </div>

                        <div class="mt-4">
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="is_adult" name="is_adult" value="1">
                                <label class="form-check-label fw-semibold" for="is_adult">
                                    Konten Dewasa
                                </label>
                            </div>
                        </div>

                    </div>

                    <!-- RIGHT COLUMN -->
                    <div class="col-md-4">

                        <label class="form-label fw-semibold">Thumbnail Preview</label>

                        <div class="thumbnail-preview mb-3">
                            <div class="ratio-box">
                                <img id="previewImage" src="/static/images/default-thumb.png" class="preview-img">
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label small">Thumbnail URL</label>
                            <input type="url" id="thumbnail_url" name="thumbnail_url" class="form-control">
                        </div>

                    </div>

                </div>

                <div class="mt-5 d-flex gap-3 action-group">
                    <button type="submit" class="btn-save">
                        <i class="bi bi-check-lg me-1"></i> Simpan
                    </button>

                    <a href="/shows" class="btn-cancel">
                        Batal
                    </a>
                </div>

            </form>
        </div>
    </div>

</div>

{% endblock %}

{% block scripts %}
<script>
    document.addEventListener("DOMContentLoaded", function () {

        // Live thumbnail preview
        const input = document.getElementById("thumbnail_url");
        const preview = document.getElementById("previewImage");

        if (input) {
            input.addEventListener("input", function () {
                const url = this.value.trim();
                preview.src = url || "/static/images/default-thumb.png";
            });
        }

        // Disable double submit
        const form = document.querySelector("form");
        if (form) {
            form.addEventListener("submit", function () {
                const btn = this.querySelector(".btn-save");
                btn.innerHTML =
                    '<span class="spinner-border spinner-border-sm me-2"></span>Menyimpan...';
                btn.disabled = true;
            });
        }

    });
</script>
{% endblock %}